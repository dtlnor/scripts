#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
; #Warn  ; Enable warnings to assist with detecting common errors.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.
#MaxHotkeysPerInterval 999

IniRead, VfioCredentials, conf.ini, Vfio, Credentials

HTTPGet(URL, Auth) {
    oHTTP := ComObjCreate("WinHttp.WinHttpRequest.5.1")
    oHTTP.Open("GET", URL , False)
    oHTTP.SetRequestHeader("Authorization", Auth)
    oHTTP.Send()
}

Key(Code, State) {
    global VfioCredentials
    HTTPGet("http://es.lan:9888/key?code=" Code "&state=" State, VfioCredentials)
}

; exit
SC03B::
    Key(67, 0)
    Key(67, 1)
    ExitApp

; F1 - F12
;SC03B::Key(67, 0)
;SC03B Up::Key(67, 1)
SC03C::Key(68, 0)
SC03C Up::Key(68, 1)
SC03D::Key(69, 0)
SC03D Up::Key(69, 1)
~SC03E::Key(70, 0)
~SC03E Up::Key(70, 1)
SC03F::Key(71, 0)
SC03F Up::Key(71, 1)
SC040::Key(72, 0)
SC040 Up::Key(72, 1)
SC041::Key(73, 0)
SC041 Up::Key(73, 1)
SC042::Key(74, 0)
SC042 Up::Key(74, 1)
SC043::Key(75, 0)
SC043 Up::Key(75, 1)
SC044::Key(76, 0)
SC044 Up::Key(76, 1)
SC057::Key(95, 0)
SC057 Up::Key(95, 1)
SC058::Key(96, 0)
SC058 Up::Key(96, 1)
; ` --> =
SC029::Key(49, 0)
SC029 Up::Key(49, 1)
SC002::Key(10, 0)
SC002 Up::Key(10, 1)
SC003::Key(11, 0)
SC003 Up::Key(11, 1)
SC004::Key(12, 0)
SC004 Up::Key(12, 1)
SC005::Key(13, 0)
SC005 Up::Key(13, 1)
SC006::Key(14, 0)
SC006 Up::Key(14, 1)
SC007::Key(15, 0)
SC007 Up::Key(15, 1)
SC008::Key(16, 0)
SC008 Up::Key(16, 1)
SC009::Key(17, 0)
SC009 Up::Key(17, 1)
SC00A::Key(18, 0)
SC00A Up::Key(18, 1)
SC00B::Key(19, 0)
SC00B Up::Key(19, 1)
SC00C::Key(20, 0)
SC00C Up::Key(20, 1)
SC00D::Key(21, 0)
SC00D Up::Key(21, 1)
; q --> ]
SC010::Key(24, 0)
SC010 Up::Key(24, 1)
SC011::Key(25, 0)
SC011 Up::Key(25, 1)
SC012::Key(26, 0)
SC012 Up::Key(26, 1)
SC013::Key(27, 0)
SC013 Up::Key(27, 1)
SC014::Key(28, 0)
SC014 Up::Key(28, 1)
SC015::Key(29, 0)
SC015 Up::Key(29, 1)
SC016::Key(30, 0)
SC016 Up::Key(30, 1)
SC017::Key(31, 0)
SC017 Up::Key(31, 1)
SC018::Key(32, 0)
SC018 Up::Key(32, 1)
SC019::Key(33, 0)
SC019 Up::Key(33, 1)
SC01A::Key(34, 0)
SC01A Up::Key(34, 1)
SC01B::Key(35, 0)
SC01B Up::Key(35, 1)
; a --> \
SC01E::Key(38, 0)
SC01E Up::Key(38, 1)
SC01F::Key(39, 0)
SC01F Up::Key(39, 1)
SC020::Key(40, 0)
SC020 Up::Key(40, 1)
SC021::Key(41, 0)
SC021 Up::Key(41, 1)
SC022::Key(42, 0)
SC022 Up::Key(42, 1)
SC023::Key(43, 0)
SC023 Up::Key(43, 1)
SC024::Key(44, 0)
SC024 Up::Key(44, 1)
SC025::Key(45, 0)
SC025 Up::Key(45, 1)
SC026::Key(46, 0)
SC026 Up::Key(46, 1)
SC027::Key(47, 0)
SC027 Up::Key(47, 1)
SC028::Key(48, 0)
SC028 Up::Key(48, 1)
SC02B::Key(51, 0)
SC02B Up::Key(51, 1)
; z --> <
SC02C::Key(52, 0)
SC02C Up::Key(52, 1)
SC02D::Key(53, 0)
SC02D Up::Key(53, 1)
SC02E::Key(54, 0)
SC02E Up::Key(54, 1)
SC02F::Key(55, 0)
SC02F Up::Key(55, 1)
SC030::Key(56, 0)
SC030 Up::Key(56, 1)
SC031::Key(57, 0)
SC031 Up::Key(57, 1)
SC032::Key(58, 0)
SC032 Up::Key(58, 1)
SC033::Key(59, 0)
SC033 Up::Key(59, 1)
SC034::Key(60, 0)
SC034 Up::Key(60, 1)
SC035::Key(61, 0)
SC035 Up::Key(61, 1)
SC073::Key(94, 0)
SC073 Up::Key(94, 1)
; rest
SC001::Key(9, 0) ; Esc
SC001 Up::Key(9, 1)
SC00E::Key(22, 0) ; BS
SC00E Up::Key(22, 1)
SC01C::Key(36, 0) ; Enter
SC01C Up::Key(36, 1)
SC00F::Key(23, 0) ; Tab
SC00F Up::Key(23, 1)
CapsLock::Key(66, 0)
CapsLock Up::Key(66, 1)
LShift::Key(50, 0)
LShift Up::Key(50, 1)
RShift::Key(62, 0)
RShift Up::Key(62, 1)
LCtrl::Key(37, 0)
LCtrl Up::Key(37, 1)
RCtrl::Key(105, 0)
RCtrl Up::Key(105, 1)
LWin::Key(133, 0)
LWin Up::Key(133, 1)
Alt::Key(64, 0)
Alt Up::Key(64, 1)
SC07B::Key(102, 0) ; muhenkan
SC07B Up::Key(102, 1)
SC039::Key(65, 0) ; space
SC039 Up::Key(65, 1)
SC079::Key(100, 0) ; henkan
SC079 Up::Key(100, 1)
SC070::Key(101, 0) ; hira/kata (BS)
SC070 Up::Key(101, 1)
AppsKey::Return
; nav
PrintScreen::Key(107, 0)
PrintScreen Up::Key(107, 1)
ScrollLock::Key(78, 0)
ScrollLock Up::Key(78, 1)
Pause::Key(127, 0)
Pause Up::Key(127, 1)
;;;
Insert::Key(118, 0)
Insert Up::Key(118, 1)
Delete::Key(119, 0)
Delete Up::Key(119, 1)
Home::Key(110, 0)
Home Up::Key(110, 1)
End::Key(115, 0)
End Up::Key(115, 1)
PgUp::Key(112, 0)
PgUp Up::Key(112, 1)
PgDn::Key(117, 0)
PgDn Up::Key(117, 1)
;;;
Up::Key(111, 0)
Up Up::Key(111, 1)
Down::Key(116, 0)
Down Up::Key(116, 1)
Left::Key(113, 0)
Left Up::Key(113, 1)
Right::Key(114, 0)
Right Up::Key(114, 1)
